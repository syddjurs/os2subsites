// |--------------------------------------------------------------------------
// | BS3 designer
// |--------------------------------------------------------------------------
// |
// | This jQuery script is written by
// | Morten Nissen
// |
// | - Optimize form elements
// | - Attach footer to bottom of page on non-touch devices
// | - Enable BS3 tooltips on non-touch devices
// | - Disable form autocomplete on non-touch devices
// | - Apply loader icon to .btn.btn-loader on click
// | - Use appear on non-touch devices
// |

// jscs:disable requireCamelCaseOrUpperCaseIdentifiers

var bs3Designer = (function ($) {
    'use strict';

    var Modernizr = {};
    var pub = {};

    /**
     * Instantiate
     */
    pub.init = function () {
        registerBootEventHandlers();
        registerEventHandlers();
    }

    /**
     * Register boot event handlers
     */
    function registerBootEventHandlers() {
        if ( ! Modernizr.touch) {
            footerAttached();
            optimizeFormElements();
        }

        appear();
        bs3Tooltip();
    }

    /**
     * Register event handlers
     */
    function registerEventHandlers() {

        $(window).resize(function () {
            footerAttached();
        });

        $('.btn-loader').on('click', function () {
            iconSpin($(this));
        });
    }

    /**
     * Footer attached
     */
    function footerAttached() {
        var $footer = $('.footer');
        var footerHeight = $footer.outerHeight(true);

        if ($('body').hasClass('footer-attached')) {
            $('.inner-wrapper').css('padding-bottom', footerHeight);
        }
    }

    /**
     * Appear
     */
    function appear() {
        var $appear = $('.appear');
        var $animation = $('.animation');

        if (Modernizr.touch || !Modernizr.cssanimations) {

            $animation
                .removeClass('animation')
                .removeClass('animation-appear-from-top')
                .removeClass('animation-appear-from-right')
                .removeClass('animation-appear-from-left')
                .removeClass('animation-appear-from-bottom')
                .removeClass('animation-appear-from-center');

            return false;
        }

        // Enable appear
        $appear.appear();

        // Force processing on animation objects
        $animation.appear({
            force_process: true
        });

        // Animation object has appeared
        $animation.on('appear', function () {

            var $element = $(this);
            var delay = $element.data('delay');

            setTimeout(function () {
                $element.addClass('animation-start');
            }, delay);
        });
    }

    /**
     * BS tooltip
     */
    function bs3Tooltip() {
        if (Modernizr.touch) {
            $('[data-toggle=tooltip]').tooltip('hide');

            return false;
        }

        $('[data-toggle=tooltip]').tooltip();
    }

    /**
     * Optimize form elements
     */
    function optimizeFormElements() {
        $('form').attr('autocomplete', 'off');
    }

    /**
     * Icon spin
     */
    function iconSpin($element) {
        $element.find('.icon').addClass('icon-spin');
    }

    return pub;
})(jQuery);
